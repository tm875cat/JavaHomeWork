SELECT CC_AVG.avg_score,tt2.name,CC_AVG.course_code  FROM
(select CT2.COURSE_CODE, round(AVG(ST2.score),2)AS AVG_SCORE 
    from SCORE_TRN2 ST2
    inner join COURSE_TRN2 CT2
    ON (ST2.COURSE_CODE=CT2.COURSE_CODE)
    group by CT2.COURSE_CODE) CC_AVG
    INNER JOIN COURSE_TRN2 
    ON (CC_AVG.COURSE_CODE =COURSE_TRN2.COURSE_CODE)
    INNER JOIN TEACHER_TRN2 tt2
    ON (TEACHER_TRN2.teacher_code =COURSE_TRN2.teacher_code)
    order by CC_AVG.AVG_SCORE desc
